from __future__ import annotations

# Heuristic alias and language constants extracted from Nlq_Parser_qtyfix_v5

import re

# Plural/singular flips for report aliases
_DEF_PLURAL_FLIPS = [
    ("דוחות", "דוח"), ("דוח", "דוחות"),
    ("מצגות", "מצגת"), ("מצגת", "מצגות"),
    ("דיבידנדים", "דיבידנד"), ("דיבידנד", "דיבידנדים"),
    ("הודעות", "הודעה"), ("הודעה", "הודעות"),
    ("מיזוגים", "מיזוג"), ("מיזוג", "מיזוגים"),
    ("פיצולים", "פיצול"), ("פיצול", "פיצולים"),
]

# Additional report alias expansions
_DEF_REPORT_EXTRAS = {"דיווח מיידי": ["דיווח", "דיווחים מיידיים"]}

# Dashes including Hebrew maqaf
_DEF_HYPHENS = "–—־"

# Hebrew month names and indices (also accept alternate spelling for March: "מרס")
_HEBREW_MONTHS = [
    "ינואר", "פברואר", "מרץ", "אפריל", "מאי", "יוני",
    "יולי", "אוגוסט", "ספטמבר", "אוקטובר", "נובמבר", "דצמבר"
]
_HEB_MONTH_IDX = {name: i + 1 for i, name in enumerate(_HEBREW_MONTHS)}
_HEB_MONTH_IDX["מרס"] = 3

_HEBREW_YEAR_WORDS = {
    "השנה": "this_year",
    "השנה הזו": "this_year",
    "השנה הנוכחית": "this_year",
    "שנה שעברה": "last_year",
    "אשתקד": "last_year",
}

# Hebrew stop words (large set)
_HEBREW_STOP_WORDS = set([
    "כלשהו", "אותה", "קרוב", "האם", "לפיהן", "תמורת", "מבין", "שלי", "עת", "קרי", "כלומר", "לאור", "אתה", "שלה", "אצלנו", "נגד", "רוב", "בינו", "מתחילת",
    "לפניכם", "מדי", "בזכות", "לפיכם", "אחרי", "לעומת", "עמכן", "הגם", "כ", "לה", "הן", "מציד", "וְ", "עליך", "ְהַ", "אצל", "מעלי", "to", "מרבית", "שמא",
    "מסביב", "ממנו", "אף", "יותר", "בשבילכם", "לא", "כיוון", "למען", "עליהן", "בהתחשב", "את", "פר", "אליו", "למשל", "אצלן", "בהתבסס", "תוך", "יו",
    "כול", "דנן", "לפיך", "מתוך", "וַ", "מעבר", "עמם", "עוד", "מטעם", "מתוכן", "בשבילן", "אלא", "עצמה", "בשבילם", "אליכן", "לבין", "לאחרי", "מקרב",
    "זו", "אלה", "יחד", "איזה", "בעוד", "לפני", "בנוגע", "מה", "ברם", "עליהם", "כן", "על-פי", "טרם", "כולה", "אילו", "לקראתו", "ביניהם", "עבר",
    "מיטב", "בקרבת", "לבד", "בשבילכן", "לפיכן", "and", "משהו", "למן", "עקב", "שום", "כמוני", "כִּי", "הואיל", "a", "אלמלא", "הּ", "בעקבות", "ביניכן",
    "בתור", "כמוהן", "בגלל", "כיאלו", "עלינו", "עצמן", "אִם", "מעל", "לקראתה", "כאילו", "של", "אך", "לאחר", "ודאי", "יען", "מכם", "מהן", "לפיהם",
    "א", "דרכ", "לפינו", "מספיק", "כמו", "כמוהם", "כַּאֲשֶר", "לפניהן", "אולם", "ב", "זוהי", "כלפי", "מחמת", "אצלכם", "לתוך", "The", "בלעדי",
    "דרך", "לפניה", "אצלכן", "הַ", "ל", "כעבור", "אנוכי", "הייתה", "עצמך", "מכן", "עמהן", "עליכם", "לבל", "בעבור", "לקראת", "באם", "גבי",
    "בשבילו", "אנחנו", "אצלה", "בלא", "אני", "עימ", "כך", "לפניהם", "במקומ", "בשבילך", "לרגל", "כש", "הָ", "ני", "פרט", "רק", "לפניך","חברת",
    "ביניכם", "בִ", "כמונו", "למרות", "אותו", "זולת", "מירב", "You", "לנוכח", "אם", "למעט", "שלכם", "בינן", "עצמו", "עַד", "אפילו", "מפאת", "כלשהי", "שלכן",
    "בידי", "שלהן", "באמצעות", "ככל", "מאשר", "כפי", "עלי", "אחד", "שכן", "דוגמת", "אתכן", "ו", "מכיוון", "בגין", "אצלו", "אגב", "אליך", "אליה", "אותן", 
    "לולא", "תחת", "נכון", "אותנו", "מבלי", "ערכ", "בינינו", "כמוך", "עם", "במקום", "במשך", "אשר", "כל", "הרבה", "בשביל", "מתחת", "ע\"פ", "מבחינת", "וֹ", 
    "סביב", "מעין", "אֹת", "כמוהו", "אצלך", "אצלי", "אוּלָם", "כמה", "גם", "כמוכן", "ללא", "תחתי", "הודות", "נוכח", "במו", "ביני", "כלל", "ש", "לרבות", 
    "מאת", "אֶל", "כיון", "כולן", "אותי", "לו", "מן", "חרף", "בו", "מביני", "יש", "בקרב", "ביד", "לקראתנו", "שלהם", "כמוכם", "אנו", "מתחתי", "עמו",
    "Your", "עמך", "מלבד", "עצמם", "עמכם", "בשבילה", "לשם", "כי", "לפנות", "בשל", "the", "לפניכן", "בעד", "פי", "כמוה", "מ", "אלינו", "משום", "לקראתי",
    "פחות", "כולם", "היו", "אחר", "עמ", "לצד", "אליהן", "עבור", "ממנ", "עליו", "הללו", "בינך", "הוא", "טרום", "ביותר", "לפי", "כולו", "כדי", "עמה", 
    "היא", "כנגד", "שאר", "נו", "בשבילי", "בינם", "עובר", "אבל", "ה", "בתוך", "עמנו", "לקראתך", "לפנינו", "אי", "כגון", "מש", "מישהו", "לציד", "ממני", 
    "שלנו", "היות", "בפני", "משל", "זה", "מי", "קודם", "of", "בטרם", "הלא", "ממנה", "עמן", "מנת", "כלשהן", "באשר", "בעקבותי", "לעניין", "שלו", "כמות", 
    "בין", "מידי", "לכבוד", "עליכן", "בגדר", "לקראתכם", "לפיו", "בניגוד", "לגבי", "החל", "מספר", "עמי", "אלי", "בה", "אליבא", "עמהם", "מאז", "או", "ממך", 
    "ביניהן", "מפני", "על", "אותם", "לעבר", "לאורך", "עלמנת", "אליהם", "לכדי", "הרי", "הם", "אלו", "לפיה", "לקראתם", "מחצית", "כם", "בלי", "בינה", "יתר", 
    "בשבילנו", "שם", "שני", "היה", "מעט", "מאחורי", "לקראתן", "מהם", "הלה", "לפניו", "עצמי", "אצלם", "מול", "מהו", "אליכם", "מאחר", "לקראתכן", "כלשהם", 
    "רובן", "מצד", "ליד", "אותך", "עליה", "ידי", "זהו", "אתכם", "שלך", "מתוכ", "לידי", "ךָ", "אֶת", "ע\"ש", "זאת", "עד", "כאשר", "אל", "עצמנו","דיווח","דיווחים"
])

# Relative unit mapping for timeframes
_REL_UNIT_MAP = {
    "יום": "days", "ימים": "days", "הימים": "days",
    "שבוע": "weeks", "שבועות": "weeks", "השבועות": "weeks",
    "חודש": "months", "חודשים": "months", "החודשים": "months",
    "שנה": "years", "שנים": "years", "השנים": "years",
    "שעה": "hours", "שעות": "hours"
}

# Hebrew numeric words used for light quantity/timeframe parsing
_HEBREW_NUM_WORDS = {
    "אחד": 1, "אחת": 1,
    "שניים": 2, "שתיים": 2,
    "שלושה": 3, "שלש": 3, "שלוש": 3,
    "ארבעה": 4, "ארבע": 4,
    "חמש": 5,
    "שש": 6,
    "שבע": 7,
    "שמונה": 8,
    "תשע": 9,
    "עשר": 10,
    "עשרים": 20,
    "שלושים": 30,
    "ארבעים": 40,
    "חמישים": 50,
    "שישים": 60,
    "שבעים": 70,
    "שמונים": 80,
    "תשעים": 90,
    "מאה": 100,
    # dual forms → numbers
    "שבועיים": 2, "חודשיים": 2, "שנתיים": 2,
}
